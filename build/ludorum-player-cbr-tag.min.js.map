{"version":3,"sources":["../src/__prologue__.js","../src/CaseBase.js","../src/CBRPlayer.js","../src/dbs/MemoryCaseBase.js","../src/__epilogue__.js","../src/dbs/SQLiteCaseBase.js","../src/utils.js"],"names":["__init__","base","Sermat","ludorum","declare","unimplemented","objects","Randomness","raise","raiseIf","Iterable","iterable","Future","exports","__package__","__name__","__dependencies__","__SERMAT__","include","dbs","utils","CaseBase","constructor","params","this","game","encoding","distance","random","DEFAULT","features1","features2","zip","mapApply","f1","f2","isNaN","Math","abs","sum","addCase","addMatch","match","options","cdb","run","then","result","i","players","forEach","p","history","entry","moves","_case","state","addMatches","matches","sequence","logger","info","populate","n","RandomPlayer","matchups","product","apply","repeat","length","toArray","range","ceil","Match","cases","nn","k","cb","gameCase","map","features","sorted","c1","c2","slice","actionEvaluations","role","roleIndex","indexOf","r","move","toObject","knn","forEachApply","m","actions","Object","values","gameEvaluation","static __SERMAT__","identifier","serializer","obj","hasOwnProperty","CBRPlayer","Player","call","caseBase","decision","movesFor","action","t","minEval","Infinity","positiveActions","filter","min","negativeActions","weightedChoice","normalizeWeights","assess","player","cbrPlayer","evaluation","matchPlayers","playerIndex","playerRole","MemoryCaseBase","__cases__","clone","push","serialize_CaseBase","SQLiteCaseBase","__setupDatabase__","Database","require","__db__","dbpath","name","toLowerCase","__tableName__","tableName","__featureColumns__","_","__actionColumns__","__resultColumns__","rt","columns","concat","sql","colName","join","prepare","err","Error","register","deterministic","varargs","__distanceFunction__","df","middle","arguments","__key__","caseKey","JSON","stringify","pi","sets","filters","all","record","col","encodings","TicTacToe","board","split","chr"],"mappings":"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","file":"ludorum-player-cbr-tag.min.js"}