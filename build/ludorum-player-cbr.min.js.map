{"version":3,"sources":["../src/__prologue__.js","../src/CaseBase.js","../src/CBRPlayer.js","../src/dbs/MemoryCaseBase.js","../src/__epilogue__.js","../src/dbs/SQLiteCaseBase.js","../src/utils.js"],"names":["__init__","base","Sermat","ludorum","declare","unimplemented","objects","Randomness","raise","raiseIf","Iterable","iterable","Future","exports","__package__","__name__","__dependencies__","__SERMAT__","include","dbs","utils","CaseBase","constructor","params","this","game","encoding","distance","random","DEFAULT","features1","features2","zip","mapApply","f1","f2","isNaN","Math","abs","sum","addCase","addMatch","match","options","cdb","run","then","result","players","forEach","p","history","entry","i","moves","_case","state","addMatches","matches","sequence","logger","info","populate","n","RandomPlayer","matchups","product","apply","repeat","length","toArray","range","ceil","Match","cases","nn","k","cb","gameCase","map","features","sorted","c1","c2","slice","actionEvaluations","role","roleIndex","indexOf","r","move","toObject","knn","forEachApply","supp","m","actions","Object","values","gameEvaluation","static __SERMAT__","identifier","serializer","obj","hasOwnProperty","CBRPlayer","Player","call","caseBase","decision","movesFor","action","t","minEval","Infinity","positiveActions","filter","min","negativeActions","weightedChoice","normalizeWeights","assess","player","cbrPlayer","evaluation","matchPlayers","playerIndex","playerRole","MemoryCaseBase","__cases__","clone","push","serialize_CaseBase","SQLiteCaseBase","__setupDatabase__","Database","require","__db__","dbpath","name","toLowerCase","pragma","__tableName__","tableName","__featureColumns__","_","__actionColumns__","__resultColumns__","rt","columns","concat","sql","colName","join","prepare","err","Error","register","deterministic","varargs","__distanceFunction__","df","middle","arguments","__key__","caseKey","JSON","stringify","ply","pi","sets","__row2case__","row","col","filters","all","bind","__nn_sql__","v1","v2","encodings","TicTacToe","board","split","chr"],"mappings":";;yTAEA,SAASA,EAASC,EAAMC,EAAQC,GAAW,aAE1C,IAAIC,EAAUH,EAAKG,QAClBC,EAAgBJ,EAAKK,QAAQD,cAG7BE,GAFQN,EAAKO,MACHP,EAAKQ,QACFR,EAAKM,YAClBG,EAAWT,EAAKS,SAChBC,EAAWV,EAAKU,SAChBC,EAASX,EAAKW,OAGXC,EAAU,CACbC,YAAa,qBACbC,SAAU,qBACVf,SAAUA,EACVgB,iBAAkB,CAACf,EAAMC,EAAQC,GACjCc,WAAY,CAAEC,QAAS,CAACjB,EAAME,IAE9BgB,IAAK,GACLC,MAAO,IClBLC,EAAWR,EAAQQ,SAAWpB,EAAKG,QAAO,CAC7CkB,YAAa,SAAkBC,GAC9BC,KAAKC,KAAOF,GAAUA,EAAOE,KACzBF,GAAqC,mBAApBA,EAAOG,WAC3BF,KAAKE,SAAWH,EAAOG,UAEpBH,GAAqC,mBAApBA,EAAOI,WAC3BH,KAAKG,SAAWJ,EAAOI,UAExBH,KAAKI,OAASL,GAAUA,EAAOK,QAAUrB,EAAWsB,SAWrDH,SAAUrB,EAAa,WAAa,8BAOpCsB,SAAU,SAAkBG,EAAWC,GACtC,OAAO9B,EAAKS,SAASsB,IAAIF,EAAWC,GAAWE,SAAS,SAAUC,EAAIC,GACrE,OAAW,OAAPD,GAAgBE,MAAMF,IAAc,OAAPC,GAAgBC,MAAMD,GAG/C,EAFAE,KAAKC,IAAIJ,EAAKC,KAIpBI,OAOJC,QAASnC,EAAa,WAAa,kBAKnCoC,SAAU,SAAkBC,EAAOC,GAElC,IAAIC,EAAMpB,KACV,OAAOkB,EAAMG,MAAMC,KAAK,WACvB,IAAIC,EAASL,EAAMK,SAenB,OAdAH,EAAInB,KAAKuB,QAAQC,QAAQ,SAAUC,GAClCH,EAAOG,GAAK,CACC,EAAZH,EAAOG,GAAS,EAAI,EACN,IAAdH,EAAOG,GAAW,EAAI,EACtBH,EAAOG,GAAK,EAAI,EAAI,KAGtBR,EAAMS,QAAQF,QAAQ,SAAUG,EAAOC,GACtC,GAAID,EAAME,MAAO,CAChB,IAAIC,EAAQX,EAAIlB,SAAS0B,EAAMI,MAAOJ,EAAME,MAAOD,GACnDE,EAAMR,OAASA,EACfH,EAAIJ,QAAQe,MAGPb,KAOTe,WAAY,SAAoBC,EAASf,GACxC,IAAIC,EAAMpB,KACT6B,EAAI,EACL,OAAOzC,EAAO+C,SAASD,EAAS,SAAUhB,GAKzC,OAJAW,IACIV,EAAQiB,QAAUP,EAAI,IAAO,GAChCV,EAAQiB,OAAOC,KAAI,SAAWR,EAAE,aAE1BT,EAAIH,SAASC,EAAOC,MAgB7BmB,SAAU,SAAkBnB,GAE3B,IACClB,GAFDkB,EAAUA,GAAW,IAELlB,MAAQD,KAAKC,KAC5BsC,EAAI3B,MAAMO,EAAQoB,GAAK,KAAOpB,EAAQoB,EACtCf,EAAUL,EAAQK,SAAW,CAAC,IAAI7C,EAAQ6C,QAAQgB,cAClDC,EAAWvD,EAASwD,QAAQC,MAAMzD,EACjCA,EAAS0D,OAAOpB,EAASvB,EAAKuB,QAAQqB,QAAQC,WAC7CA,UACH,OAAO9C,KAAKiC,WAAW/C,EAAS6D,MAAMlC,KAAKmC,KAAKT,EAAIE,EAASI,SAC3DH,QAAQD,GACRhC,SAAS,SAAUoB,EAAGL,GACtB,OAAO,IAAI7C,EAAQsE,MAAMhD,EAAMuB,KAC5BL,IAQN+B,MAAOrE,EAAa,WAAa,kBAIjCsE,GAAI,SAAYC,EAAGnD,GAClB,IAAIoD,EAAKrD,KACRsD,EAAWtD,KAAKE,SAASD,GAM1B,OALMd,EAASa,KAAKkD,SAASK,IAAI,SAAUxB,GACzC,MAAO,CAACA,EAAOsB,EAAGlD,SAAS4B,EAAMyB,SAAUF,EAASE,aAClDC,OAAO,SAAUC,EAAIC,GACvB,OAAOD,EAAG,GAAKC,EAAG,KAChBb,UACMc,MAAM,GAAIR,IAKrBS,kBAAmB,SAA2B5D,EAAM6D,EAAM3C,GACzD,IACCiC,EAAIjC,IAAYA,EAAQiC,GAAK,GAC7BW,EAAY9D,EAAKuB,QAAQwC,QAAQF,GACjCG,EAAIxF,EAAKU,SAASc,EAAK6B,QAAQgC,IAAOP,IAAI,SAAUW,GACnD,MAAO,CAACA,EAAK,GAAK,CAACA,EAAM,MACvBC,WACHC,EANQpE,KAMCmD,GAAGC,EAAGnD,GAUhB,OATAd,EAASiF,GAAKC,aAAa,SAAUtC,EAAO5B,GAC3C,IACCmE,EADGC,EAAIN,EAAElC,EAAMyC,QAAQT,IAEpBQ,IACHD,EAAOvC,EAAMR,OAAOuC,GAAM,GAAK/B,EAAMR,OAAOuC,GAAM,GAAK/B,EAAMR,OAAOuC,GAAM,GAC1ES,EAAE,IAAMD,GAAQvC,EAAMR,OAAOuC,GAAM,GAAK/B,EAAMR,OAAOuC,GAAM,KACzD,GAAKQ,IAAS,EAAInE,MAGfsE,OAAOC,OAAOT,IAKtBU,eAAgB,SAAwB1E,EAAM6D,EAAM3C,GACnD,IACCiC,EAAIjC,IAAYA,EAAQiC,GAAK,GAI7BgB,GAHI3F,EAAKU,SAASc,EAAK6B,QAAQgC,IAAOP,IAAI,SAAUW,GACnD,MAAO,CAACA,EAAK,GAAK,CAACA,EAAM,MACvBC,WAJKnE,KAKCmD,GAAGC,EAAGnD,EAAM6D,IACtB,OAAO3E,EAASiF,GAAKb,IAAI,SAAUxB,EAAO5B,GACzC,OAAQ4B,EAAMR,OAAOuC,GAAM,GAAK/B,EAAMR,OAAOuC,GAAM,KAAO,EAAI3D,KAC5DY,OAKJ6D,oBAAqB,CACpBC,WAAY,WACZC,WAAY,SAA4BC,GACvC,MAAO,CAAA,CACN9E,KAAM8E,EAAI9E,KACVC,SAAU6E,EAAIC,eAAc,YAAeD,EAAI7E,SAAW,WChL9Db,EAAQ4F,UAAYxG,EAAKG,QAAQD,EAAQuG,OAAQ,CAGhDpF,YAAa,SAAmBC,GAC/BpB,EAAQuG,OAAOC,KAAKnF,KAAMD,GAC1BC,KAAKoF,SAAWrF,GAAUA,EAAOqF,SACjCpF,KAAKoD,EAAIrD,GAAUA,EAAOqD,GAAK,IAShCiC,SAAU,SAAkBpF,EAAM6D,GACjC,IAAIU,EAAUrF,EAASa,KAAKsF,SAASrF,EAAM6D,IAAOP,IAAI,SAAUgC,GAC9D,MAAO,CAACA,EAAO,GAAK,CAACA,EAAQ,MAC3BpB,WACJnE,KAAKoF,SAASvB,kBAAkB5D,EAAM6D,EAAM,CAAEV,EAAGpD,KAAKoD,IAAK3B,QAAQ,SAAU+D,GAC5E,IAAI5D,EAAQ4C,EAAQgB,EAAE,GAAG,IACrB5D,IACHA,EAAM,IAAM4D,EAAE,MAGhB,IAAIC,EAAWC,EAAAA,EACdC,EAAkBlB,OAAOC,OAAOF,GAASoB,OAAO,SAAUJ,GAEzD,OADAC,EAAU5E,KAAKgF,IAAIJ,EAASD,EAAE,IAChB,EAAPA,EAAE,KAEVM,EAAkBrB,OAAOC,OAAOF,GAASoB,OAAO,SAAUJ,GACzD,OAAOA,EAAE,IAAM,IACbjC,IAAI,SAAUiC,GAChB,MAAO,CAACA,EAAE,GAAIA,EAAE,GAAKC,KAUvB,OAP6B,EAAzBE,EAAgB9C,OACV7C,KAAKI,OAAO2F,eAAe/F,KAAKI,OAAO4F,iBAAiBL,IAC5B,IAA3BA,EAAgB9C,OACjB8C,EAAgB,GAAG,GAEnB3F,KAAKI,OAAO2F,eAAe/F,KAAKI,OAAO4F,iBAAiBF,KAOnEG,OAAQ,SAAgBC,EAAQ/E,GAC/B,IAAIgF,EAAYnG,KACfC,EAAOD,KAAKoF,SAASnF,KACrBmG,EAAa3H,EAAKU,SAASc,EAAKuB,SAAS+B,IAAI,SAAU7B,GACtD,MAAO,CAACA,EAAG,CAAC,EAAE,EAAE,MACdyC,WACH3C,EAAU/C,EAAKS,SAAS0D,OAAOsD,EAAQjG,EAAKuB,QAAQqB,QAAQC,UAC5DP,EAAIpB,IAAYA,EAAQoB,GAAK,IAC9B,OAAO9D,EAAKW,OAAO+C,SAAS1D,EAAKS,SAAS6D,MAAMR,GAAI,SAAUV,GAC7D,IAAIwE,EAAe7E,EAAQoC,QAC1B0C,EAAczE,EAAI5B,EAAKuB,QAAQqB,OAC/B0D,EAAatG,EAAKuB,QAAQ8E,GAC3BD,EAAaC,GAAeH,EAC5B,IAAIjF,EAAQ,IAAIvC,EAAQsE,MAAMhD,EAAMoG,GACpC,OAAOnF,EAAMG,MAAMC,KAAK,WACnBH,EAAQiB,QAAc,EAAJP,GAASA,EAAI,IAAO,GACzCV,EAAQiB,OAAOC,KAAI,kBAAoBR,EAAE,aAE1C,IAAIoC,EAAI/C,EAAMK,SAASgF,GACvBH,EAAWG,GAAgB,EAAJtC,EAAQ,EAAIA,EAAI,EAAI,EAAI,SAE9C3C,KAAK,WACP,OAAO8E,OCrEW/G,EAAQM,IAAI6G,eAAiB5H,EAAQiB,EAAU,CACnEC,YAAa,SAAwBC,GACpCF,EAASsF,KAAKnF,KAAMD,GACpBC,KAAKyG,UAAY,IAGlBvD,MAAO,WACN,OAAOzE,EAAKU,SAASa,KAAKyG,YAG3BzF,QAAS,SAAiBe,GAEzB,IAAIH,EAAQ,CACX4B,SAAU9E,EAAOgI,MAAM3E,EAAMyB,UAAY,MACzCgB,QAAS9F,EAAOgI,MAAM3E,EAAMyC,SAAW,MACvCjD,OAAQ7C,EAAOgI,MAAM3E,EAAMR,QAAU,OAEtC,OAAOvB,KAAKyG,UAAUE,KAAK/E,IAK5BgD,oBAAqB,CACpBC,WAAY,iBACZC,WAAY,SAAkCC,GAC7C,OAAOlF,EAASJ,WAAWmH,mBAAmB7B,OC5BhD,OCGD1F,EAAQM,IAAIkH,eAAiBpI,EAAKG,QAAQiB,EAAU,CAGnDC,YAAa,SAAwBC,GACpCF,EAASsF,KAAKnF,KAAMD,GACpBC,KAAK8G,kBAAkB/G,IAOxB+G,kBAAmB,SAA2B/G,GAC7C,IAAIE,EAAOD,KAAKC,KACf8G,EAAW/G,KAAK+G,UAAYC,QAAO,kBACpChH,KAAKiH,OAAS,IAAIF,EAAShH,EAAOmH,QAAU,KAAMjH,EAAKkH,KAAKC,cAAc,eAC1EpH,KAAKiH,OAAOI,OAAM,sBAClBrH,KAAKiH,OAAOI,OAAM,wBAClBrH,KAAKiH,OAAOI,OAAM,sBAElBrH,KAAKsH,cAAgBvH,EAAOwH,WAAa,MAAOtH,EAAKkH,KACrD,IAAIjH,EAAWF,KAAKE,SAASD,EAAMA,EAAK6B,SACxC9B,KAAKwH,mBAAqBtH,EAASsD,SAASD,IAAI,SAAUkE,EAAG5F,GAC5D,MAAO,IAAKA,IAEb7B,KAAK0H,kBAAoBzH,EAAKuB,QAAQ+B,IAAI,SAAUkE,EAAG5F,GACtD,MAAO,IAAKA,IAEb7B,KAAK2H,kBAAoBlJ,EAAKS,SAAS6D,MAAM9C,EAAKuB,QAAQqB,QACxDH,QAAO,CAAA,MAAS,OAAQ,SACxBjC,SAAS,SAAUiB,EAAGkG,GACtB,OAAOA,EAAKlG,IACVoB,UACJ,IAAI+E,EAAU7H,KAAKwH,mBAChBM,OAAO9H,KAAK0H,mBACZI,OAAO9H,KAAK2H,mBACdI,EAAM,8BAA+B/H,KAAKsH,cACzC,mDACAO,EAAQtE,IAAI,SAAUyE,GACrB,OAAOA,EAAQ,aACbC,KAAI,MAAO,IAChB,IACCjI,KAAKiH,OAAOiB,QAAQH,GAAK1G,MACxB,MAAO8G,GACR,MAAM,IAAIC,MAAK,qCAAuCL,EAAI,MAE3D/H,KAAKiH,OAAOoB,SAAQ,CAAGlB,KAAM,WAAYmB,eAAe,EAAMC,SAAS,GACtEvI,KAAKwI,qBAAqBxI,KAAKG,YAOjCqI,qBAAsB,SAA8BC,GACnDA,EAAKA,GAAMzI,KAAKG,SAChB,IAAIG,EAAY,GACfC,EAAY,GACb,OAAO,WAEN,IADA,IAAImI,EAAUC,UAAU9F,OAAS,EAAI,EAC5BhB,EAAI,EAAGA,EAAI6G,EAAQ7G,IAC3BvB,EAAUqG,KAAKgC,UAAU9G,IACzBtB,EAAUoG,KAAKgC,UAAUD,EAAS7G,IAEnC,OAAO4G,EAAGnI,EAAWC,KASvBqI,QAAS,SAAiB7G,GACzB,IAAIyB,EAAWzB,EAAMyB,SACpBgB,EAAUzC,EAAMyC,SAAWxE,KAAKC,KAAKuB,QAAQ+B,IAAI,WAChD,OAAO,OAET,OAAOC,EAASyE,KAAI,KAAM,IAAMzD,EAAQyD,KAAI,MAG7CjH,QAAS,SAAiBe,GACzB,IAAIP,EAAUxB,KAAKC,KAAKuB,QACvBqH,EAAU,IAAM7I,KAAK4I,QAAQ7G,GAAO,IACpCgG,EAAM,yBAA0B/H,KAAKsH,cAAc,YAAc,CAACuB,EAAS,EAAG,GAC5Ef,OAAO/F,EAAMyB,SAASD,IAAIuF,KAAKC,YAC/BjB,OAAO/F,EAAMyC,QAAQjB,IAAIuF,KAAKC,YAC9BjB,OAAOrJ,EAAKS,SAAS0D,OAAO,EAAoB,EAAjBpB,EAAQqB,QAAYC,WACnDmF,KAAI,KAAM,IACbjI,KAAKiH,OAAOiB,QAAQH,GAAK1G,MACzB0G,EAAM,UAAW/H,KAAKsH,cAAc,iDACcvF,EAAMiH,KAAO,GAAG,oBACjExH,EAAQ+B,IAAI,SAAU7B,GACrB,IAAIuC,EAAIlC,EAAMR,OAAOG,GACpBuH,EAAKzH,EAAQwC,QAAQtC,GACrBwH,EAAO,GAUR,OATIjF,EAAE,IACLiF,EAAKvC,KAAI,MAAQsC,EAAG,SAAWA,EAAG,MAAQhF,EAAE,IAEzCA,EAAE,IACLiF,EAAKvC,KAAI,OAASsC,EAAG,UAAYA,EAAG,MAAQhF,EAAE,IAE3CA,EAAE,IACLiF,EAAKvC,KAAI,OAASsC,EAAG,UAAYA,EAAG,MAAQhF,EAAE,IAExCiF,EAAKjB,KAAI,QACdA,KAAI,MAAO,gBAAkBY,EACjC7I,KAAKiH,OAAOiB,QAAQH,GAAK1G,OAG1B8H,aAAc,SAAsBC,GACnC,MAAO,CACNJ,IAAKI,EAAIJ,IACTxF,SAAUxD,KAAKwH,mBAAmBjE,IAAI,SAAU8F,GAC/C,OAAOD,EAAIC,KAEZ7E,QAASxE,KAAK0H,kBAAkBnE,IAAI,SAAU8F,GAC7C,OAAOD,EAAIC,KAEZ9H,OAAQpC,EAASa,KAAKC,KAAKuB,SAAS+B,IAAI,SAAU2C,EAAQrE,GACzD,MAAO,CAACqE,EAAQ,CAACkD,EAAG,MAAQvH,GAAIuH,EAAG,OAASvH,GAAIuH,EAAG,OAASvH,OAC1DsC,aAILjB,MAAO,SAAeoG,GACrB,IAAIvB,EAAM,iBAAkB/H,KAAKsH,cACjC,OAAOtH,KAAKiH,OAAOiB,QAAQH,GAAKwB,MAAMhG,IAAIvD,KAAKmJ,aAAaK,KAAKxJ,QAGlEyJ,WAAY,SAAoBrG,EAAGnD,GAClC,IAAIqD,EAAWtD,KAAKE,SAASD,GAC7B,MAAO,cACNf,EAASsB,IAAIR,KAAKwH,mBAAoBlE,EAASE,UAAU/C,SAAS,SAAUiJ,EAAIC,GAC/E,OAAc,OAAPA,GAAgB/I,MAAM+I,GAA2C,IAArC,cAAeD,EAAG,IAAMC,EAAG,SAC5D1B,KAAI,KAAM,sBACJjI,KAAKsH,cAAc,gCACIlE,GAGlCD,GAAI,SAAYC,EAAGnD,GAClB,IAAIoD,EAAKrD,KACR+H,EAAM/H,KAAKyJ,WAAWrG,EAAGnD,GAC1B,OAAOD,KAAKiH,OAAOiB,QAAQH,GAAKwB,MAAMhG,IAAI,SAAU6F,GACnD,MAAO,CAAC/F,EAAG8F,aAAaC,GAAMA,EAAIjJ,aAMpCyE,oBAAqB,CACpBC,WAAY,iBACZC,WAAY,SAAkCC,GAC7C,OAAOlF,EAASJ,WAAWmH,mBAAmB7B,OCvJjD1F,EAAQO,MAAMgK,UAAY,CAMzBC,UAAW,SAA2B5J,EAAM6B,EAAOkH,GAClD,MAAO,CACNA,IAAKA,EACLxF,SAAUvD,EAAK6J,MAAMC,MAAK,IAAKxG,IAAI,SAAUyG,GAC5C,MAAe,MAARA,EAAc,EAAY,MAARA,EAAc,EAAI,IAE5CxF,QAAU1C,EAAe7B,EAAKuB,QAAQ+B,IAAI,SAAU7B,GACnD,OAAOI,EAAMkD,eAAetD,GAAKI,EAAMJ,GAAK,OAD3B,QFjBbrC","file":"ludorum-player-cbr.min.js"}