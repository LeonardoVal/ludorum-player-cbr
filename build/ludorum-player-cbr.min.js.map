{"version":3,"sources":["../src/__prologue__.js","../src/CaseBase.js","../src/CBRPlayer.js","../src/dbs/MemoryCaseBase.js","../src/__epilogue__.js","../src/dbs/SQLiteCaseBase.js","../src/utils.js"],"names":["__init__","base","Sermat","ludorum","declare","unimplemented","objects","Randomness","raise","raiseIf","Iterable","iterable","Future","exports","__package__","__name__","__dependencies__","__SERMAT__","include","dbs","utils","CaseBase","constructor","params","this","game","encoding","distance","random","DEFAULT","features1","features2","zip","mapApply","f1","f2","isNaN","Math","abs","sum","addCase","addMatch","match","options","cdb","run","then","result","players","forEach","p","history","entry","i","moves","_case","state","addMatches","matches","matchCount","intervalId","logger","setInterval","info","logTime","sequence","r","clearInterval","populate","n","trainer","RandomPlayer","name","Array","isArray","matchups","tournaments","Measurement","__matches__","toArray","range","ceil","length","product","Match","cases","nn","k","cb","gameCase","map","features","sorted","c1","c2","slice","actionEvaluations","role","roleIndex","indexOf","move","JSON","stringify","toObject","knn","forEachApply","supp","m","actions","Object","values","gameEvaluation","static __SERMAT__","identifier","serializer","obj","hasOwnProperty","CBRPlayer","Player","call","caseBase","decision","movesFor","action","t","minEval","Infinity","positiveActions","filter","min","negativeActions","weightedChoice","normalizeWeights","assess","cbrPlayer","evaluation","player","finishedMatchesCount","tuple","matchPlayers","repeat","playerIndex","playerRole","MemoryCaseBase","__cases__","clone","push","serialize_CaseBase","SQLiteCaseBase","__setupDatabase__","Database","require","__db__","dbpath","toLowerCase","pragma","__tableName__","tableName","__featureColumns__","_","__actionColumns__","__resultColumns__","rt","sql","colName","join","concat","prepare","err","Error","register","deterministic","varargs","__distanceFunction__","df","middle","arguments","__key__","caseKey","sqlStmt","apply","ply","chain","changes","pi","sets","__row2case__","row","col","parse","filters","all","bind","__nn_sql__","v1","v2","encodings","TicTacToe","board","split","chr"],"mappings":"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","file":"ludorum-player-cbr.min.js"}