{"version":3,"sources":["../src/__prologue__.js","../src/CaseBase.js","../src/CBRPlayer.js","../src/dbs/MemoryCaseBase.js","../src/__epilogue__.js","../src/dbs/SQLiteCaseBase.js","../src/utils.js"],"names":["__init__","base","Sermat","ludorum","declare","unimplemented","objects","Randomness","raise","raiseIf","Iterable","iterable","Future","exports","__package__","__name__","__dependencies__","__SERMAT__","include","dbs","utils","CaseBase","constructor","params","this","game","encoding","distance","random","DEFAULT","features1","features2","zip","mapApply","f1","f2","isNaN","Math","abs","sum","addCase","addMatch","match","options","cdb","run","then","result","players","forEach","p","history","entry","i","moves","_case","state","addMatches","matches","sequence","logger","info","populate","n","RandomPlayer","matchups","product","apply","repeat","length","toArray","range","ceil","Match","cases","nn","k","cb","gameCase","map","features","sorted","c1","c2","slice","actionEvaluations","role","roleIndex","indexOf","r","move","JSON","stringify","toObject","knn","forEachApply","supp","m","actions","Object","values","gameEvaluation","static __SERMAT__","identifier","serializer","obj","hasOwnProperty","CBRPlayer","Player","call","caseBase","decision","movesFor","action","t","minEval","Infinity","positiveActions","filter","min","negativeActions","weightedChoice","normalizeWeights","assess","player","cbrPlayer","evaluation","matchPlayers","playerIndex","playerRole","MemoryCaseBase","__cases__","clone","push","serialize_CaseBase","SQLiteCaseBase","__setupDatabase__","Database","require","__db__","dbpath","name","toLowerCase","pragma","__tableName__","tableName","__featureColumns__","_","__actionColumns__","__resultColumns__","rt","sql","colName","join","concat","prepare","err","Error","register","deterministic","varargs","__distanceFunction__","df","middle","arguments","__key__","caseKey","sqlStmt","ply","chain","changes","pi","sets","__row2case__","row","col","parse","filters","all","bind","__nn_sql__","v1","v2","encodings","TicTacToe","board","split","chr"],"mappings":"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","file":"ludorum-player-cbr.min.js"}