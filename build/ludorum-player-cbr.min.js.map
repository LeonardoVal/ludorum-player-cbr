{"version":3,"sources":["../src/__prologue__.js","../src/CaseBase.js","../src/CBRPlayer.js","../src/dbs/MemoryCaseBase.js","../src/__epilogue__.js","../src/dbs/SQLiteCaseBase.js","../src/utils.js"],"names":["__init__","base","Sermat","ludorum","declare","unimplemented","objects","Randomness","raise","raiseIf","Iterable","iterable","Future","exports","__package__","__name__","__dependencies__","__SERMAT__","include","dbs","utils","CaseBase","constructor","params","this","game","encoding","distance","random","DEFAULT","features1","features2","zip","mapApply","f1","f2","isNaN","Math","abs","sum","addCase","addMatch","match","options","cdb","run","then","result","players","forEach","p","history","entry","i","moves","_case","state","addMatches","matches","sequence","logger","info","populate","n","RandomPlayer","matchups","product","apply","repeat","length","toArray","range","ceil","Match","cases","nn","k","cb","gameCase","map","features","sorted","c1","c2","slice","actionEvaluations","role","roleIndex","indexOf","r","move","toObject","knn","forEachApply","m","actions","Object","values","gameEvaluation","static __SERMAT__","identifier","serializer","obj","hasOwnProperty","CBRPlayer","Player","call","caseBase","decision","movesFor","action","t","minEval","Infinity","positiveActions","filter","min","negativeActions","weightedChoice","normalizeWeights","assess","player","cbrPlayer","evaluation","matchPlayers","playerIndex","playerRole","MemoryCaseBase","__cases__","clone","push","serialize_CaseBase","SQLiteCaseBase","__setupDatabase__","Database","require","__db__","dbpath","name","toLowerCase","pragma","__tableName__","tableName","__featureColumns__","_","__actionColumns__","__resultColumns__","rt","columns","concat","sql","colName","join","prepare","err","Error","register","deterministic","varargs","__distanceFunction__","df","middle","arguments","__key__","caseKey","JSON","stringify","ply","pi","sets","__row2case__","row","col","filters","all","bind","__nn_sql__","v1","v2","encodings","TicTacToe","board","split","chr"],"mappings":"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","file":"ludorum-player-cbr.min.js"}